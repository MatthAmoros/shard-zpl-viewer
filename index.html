
<input type='text' id='label'/>
<input type="button" onclick="displayLabel('myCanvas', $('#label').val());" value="preview" />
<canvas id='myCanvas' height="1000" width="1000">
</canvas>
<div id='demo'></div>

<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="jquery-barcode.js"></script>
<script>

//Init
var label = '^XA' +
'^LH0,0^FS' +         
'^FO280,20^A0N,36,34^CI13^FR^FD DATE: <RECEPTION_DATE>^FS'+
'^FO280,80^A0N,36,34^CI13^FR^FD <GROWER_GROUP>^FS'+
'^FO280,110^A0N,36,34^CI13^FR^FD <ORIGIN>^FS'+
'^FO280,140^A0N,36,34^CI13^FR^FD <DESTINATION>^FS'+
'^FO280,180^A0N,36,34^CI13^FR^FD FAMILY: <PRODUCT_FAMILY>^FS'+
'^FO280,210^A0N,36,34^CI13^FR^FD TYPE: <PRODUCT_TYPE>^FS'+
'^FO280,280^A0N,36,34^CI13^FR^FD PRODUCT: <PRODUCT>^FS'+
'^FO280,340^A0N,36,34^CI13^FR^FD ID: <ID>^FS'+
'^FO20,100^BXN,15,200'+
'^FD<ID>^FS'+
'^PQ1,0,0,N'+
'^XZ';

//displayLabel('myCanvas', label);

function displayLabel(canvasId, label) {
  //Init canvas
  var c = document.getElementById(canvasId);
  var ctx = c.getContext("2d");
  
  //Get each command
  var textsMatches = label.match(/\^FO([^\r\n]*)\^FS/g);
  try {
    if(textsMatches.length > 0) {
      var texts = textsMatches[0].split('FS');
      texts.forEach(function (text) {
        let formatedText = text.replace('^FO', '').replace('^FS', '');
        let properties = formatedText.split('^');
        
        //First, postion like : 280, 30
        let position = properties[0].split(',');
        
        if (properties.length > 2) {
          if(properties[1].indexOf('A') >= 0) {
            //Text
            ctx.font = getFontFromCode(properties[1]);
            let textValue = properties[4].replace('FD', '');
            ctx.fillText(textValue, position[0], position[1]);
          }
          else if(properties[1].indexOf('B') >= 0) {
            //Skip barcode options, shift properties index
            if (properties[1].startsWith("BY") 
            && properties[2].startsWith("B")) { 
              let textValue = properties[3].replace('FD', '');
              $("#" + canvasId).barcode(
              textValue,
              getBarcodeTypeFromCode(properties[2]), //Switch according to barcode type
              {output:'canvas', posX:20, posY:200, showHRI:false}
              );
            }
            //Barcode
            // https://barcode-coder.com/en/barcode-jquery-plugin-201.html
            let textValue = properties[2].replace('FD', '');
            $("#" + canvasId).barcode(
            textValue,
            getBarcodeTypeFromCode(properties[1]), //Switch according to barcode type
            {output:'canvas', posX:20, posY:200, showHRI:false}
            );
          }
        }
      });
      
    }
  }
  catch(error) {
    console.error(error);
  }
}

function getBarcodeTypeFromCode(code) {
  let properties = code.split(',');
  console.log(properties);
}

function getFontFromCode(code) {
  let fontName = 'Courrier Sans MS'
  let fontSize = 'px'
  
  properties = code.split(',');
  
  switch (properties[0]) {
    case 'A0N':
      fontName = 'Courrier Sans MS'
      break;
    
    default:
      break;
  }
  
  fontSize = properties[1] + fontSize;
  
  return fontSize + ' ' + fontName;
}

</script>